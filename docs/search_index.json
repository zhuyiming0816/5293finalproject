[["index.html", "Prediction of Heart Attack Chapter 1 Proposal", " Prediction of Heart Attack Yiming Zhu 2023-04-24 Chapter 1 Proposal With 17.9 million deaths per year, or 31% of all deaths worldwide, cardiovascular diseases (CVDs) are the leading cause of mortality worldwide. Heart attacks and strokes account for four out of every five CVD fatalities, and one-third of these deaths happen before the age of 70. Heart failure is a frequent complication of CVDs, and this dataset comprises 11 variables that might be used to anticipate the development of a potential heart condition. A machine learning model can be very helpful in the early diagnosis and care of people with cardiovascular disease or who are at high cardiovascular risk (due to the presence of one or more risk factors including hypertension, diabetes, hyperlipidaemia, or previously existing illness). For this project, I will examine the Heart Attack Analysis &amp; Prediction Dataset. The original data set has 14 columns as follows. Age: Age of the patient Sex: Sex of the patient exang: exercise induced angina (1 = yes; 0 = no) ca: number of major vessels (0-3) cp: Chest Pain type chest pain type Value 1: typical angina Value 2: atypical angina Value 3: non-anginal pain Value 4: asymptomatic trtbps : resting blood pressure (in mm Hg) chol: cholestoral in mg/dl fetched via BMI sensor fbs : (fasting blood sugar &gt; 120 mg/dl) (1 = true; 0 = false) rest_ecg: resting electrocardiographic results Value 0: normal Value 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV) Value 2: showing probable or definite left ventricular hypertrophy by Estes’ criteria thalach: maximum heart rate achieved target: 0 = less chance of heart attack 1 = more chance of heart attack The goal of this project is to predict the probability of whether a person is likely to have a heart attack based on their gender, age, cholesterol level using a linear model as the baseline model, a logistic model, and a Nrandom forest model. In addition, I will compare the result of all three models with the ‘target’ variable, which is the prediction of heart attack provided by the data author. This repo was initially generated from a bookdown template available here: https://github.com/jtr13/IMLVtemplate. Data source: https://archive.ics.uci.edu/ml/datasets/Heart+Disease (UCI) "],["model-1.html", "Chapter 2 [Model 1]", " Chapter 2 [Model 1] Firstly, we load the data and convert all chracter variables to factor variables. ## &#39;data.frame&#39;: 918 obs. of 12 variables: ## $ Age : int 40 49 37 48 54 39 45 54 37 48 ... ## $ Sex : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 1 2 1 2 2 1 2 2 1 ... ## $ ChestPainType : Factor w/ 4 levels &quot;ASY&quot;,&quot;ATA&quot;,&quot;NAP&quot;,..: 2 3 2 1 3 3 2 2 1 2 ... ## $ RestingBP : int 140 160 130 138 150 120 130 110 140 120 ... ## $ Cholesterol : int 289 180 283 214 195 339 237 208 207 284 ... ## $ FastingBS : int 0 0 0 0 0 0 0 0 0 0 ... ## $ RestingECG : Factor w/ 3 levels &quot;LVH&quot;,&quot;Normal&quot;,..: 2 2 3 2 2 2 2 2 2 2 ... ## $ MaxHR : int 172 156 98 108 122 170 170 142 130 120 ... ## $ ExerciseAngina: Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 2 1 ... ## $ Oldpeak : num 0 1 0 1.5 0 0 0 0 1.5 0 ... ## $ ST_Slope : Factor w/ 3 levels &quot;Down&quot;,&quot;Flat&quot;,..: 3 2 3 2 3 3 3 3 2 3 ... ## $ HeartDisease : int 0 1 0 1 0 0 0 0 1 0 ... Firstly, we split data with 80/20. Then we predict the logistic regression on all the variables. ## ## Call: ## lm(formula = HeartDisease ~ ., data = train_data) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.99914 -0.14010 0.00686 0.18379 0.97993 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.853e-01 1.690e-01 2.280 0.022905 * ## Age 3.040e-03 1.535e-03 1.980 0.048036 * ## SexM 1.568e-01 3.153e-02 4.973 8.26e-07 *** ## ChestPainTypeATA -2.369e-01 3.814e-02 -6.212 8.86e-10 *** ## ChestPainTypeNAP -2.194e-01 3.258e-02 -6.735 3.35e-11 *** ## ChestPainTypeTA -1.911e-01 5.827e-02 -3.279 0.001092 ** ## RestingBP 5.598e-05 6.975e-04 0.080 0.936057 ## Cholesterol -5.153e-04 1.246e-04 -4.136 3.95e-05 *** ## FastingBS 1.189e-01 3.071e-02 3.871 0.000118 *** ## RestingECGNormal 1.288e-02 3.302e-02 0.390 0.696690 ## RestingECGST -2.042e-03 4.067e-02 -0.050 0.959966 ## MaxHR -2.055e-04 6.014e-04 -0.342 0.732673 ## ExerciseAnginaY 1.295e-01 3.108e-02 4.168 3.45e-05 *** ## Oldpeak 5.399e-02 1.398e-02 3.861 0.000123 *** ## ST_SlopeFlat 1.565e-01 5.245e-02 2.984 0.002940 ** ## ST_SlopeUp -2.356e-01 5.834e-02 -4.037 5.98e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.3316 on 719 degrees of freedom ## Multiple R-squared: 0.5648, Adjusted R-squared: 0.5557 ## F-statistic: 62.2 on 15 and 719 DF, p-value: &lt; 2.2e-16 ## lm.prediction ## 0 1 ## 0 69 13 ## 1 6 95 ## [1] 0.8961749 The accuracy rate is 89.61749%. "],["model-2.html", "Chapter 3 [Model 2]", " Chapter 3 [Model 2] Then we predict the logistic regression on all the variables. ## ## Call: ## glm(formula = HeartDisease ~ ., family = binomial(link = &quot;logit&quot;), ## data = train_data) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.6113 -0.3876 0.1815 0.4623 2.6343 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -2.0172393 1.5730873 -1.282 0.199722 ## Age 0.0237821 0.0149542 1.590 0.111760 ## SexM 1.4089327 0.3083171 4.570 4.88e-06 *** ## ChestPainTypeATA -1.7436606 0.3570518 -4.883 1.04e-06 *** ## ChestPainTypeNAP -1.6332337 0.2891257 -5.649 1.62e-08 *** ## ChestPainTypeTA -1.5017144 0.4709041 -3.189 0.001428 ** ## RestingBP 0.0025601 0.0066686 0.384 0.701048 ## Cholesterol -0.0041877 0.0011893 -3.521 0.000430 *** ## FastingBS 1.0007113 0.3010009 3.325 0.000885 *** ## RestingECGNormal 0.1095094 0.2985768 0.367 0.713790 ## RestingECGST -0.0680890 0.3938741 -0.173 0.862754 ## MaxHR 0.0006257 0.0055325 0.113 0.909956 ## ExerciseAnginaY 0.8881765 0.2710944 3.276 0.001052 ** ## Oldpeak 0.4137062 0.1309423 3.159 0.001581 ** ## ST_SlopeFlat 1.3637780 0.4846539 2.814 0.004894 ** ## ST_SlopeUp -1.1646171 0.5053302 -2.305 0.021185 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1010.42 on 734 degrees of freedom ## Residual deviance: 488.17 on 719 degrees of freedom ## AIC: 520.17 ## ## Number of Fisher Scoring iterations: 5 ## glm.prediction ## 0 1 ## 0 68 14 ## 1 7 94 ## [1] 0.8852459 The accuracy rate is 88.52459%. "],["model-3.html", "Chapter 4 [Model 3]", " Chapter 4 [Model 3] Then we perform the random forest model. ## IncNodePurity ## Age 12.135311 ## Sex 6.025464 ## ChestPainType 22.595150 ## RestingBP 10.243862 ## Cholesterol 16.662321 ## FastingBS 4.125195 ## RestingECG 4.615653 ## MaxHR 16.826733 ## ExerciseAngina 14.002542 ## Oldpeak 17.115808 ## ST_Slope 41.904318 ## rf.prediction ## 0 1 ## 0 66 16 ## 1 5 96 ## [1] 0.8852459 The accuracy rate is 89.61749%. "],["reflections.html", "Chapter 5 Reflections", " Chapter 5 Reflections Linear models: 89.61749% Logistic Regression Model : 88.52459% Random Forest Model : 89.61749% Based on the result, we can see that even if the "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
